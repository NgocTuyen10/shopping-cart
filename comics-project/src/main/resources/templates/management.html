<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Comics Store</title>
	<link rel="stylesheet" th:href="@{/webjars/bootstrap/3.3.7/css/bootstrap.min.css}">
	<link rel="stylesheet" th:href="@{/webjars/datatables/1.10.19/css/jquery.dataTables.min.css}">
	<link rel="stylesheet" th:href="@{/webjars/bootstrap-multiselect/0.9.15/css/bootstrap-multiselect.css}">
	<link rel="stylesheet" th:href="@{/css/main.css}">
	<link rel="stylesheet" th:href="@{/css/pagination.css}">
	<script type="text/javascript" th:src="@{/webjars/jquery/3.3.1/jquery.min.js}"></script>
	<script type="text/javascript" th:src="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.js}"></script>
	<script type="text/javascript" th:src="@{/webjars/bootstrap/3.3.7/js/bootstrap.min.js}"></script>
	<script type="text/javascript" th:src="@{/webjars/datatables/1.10.19/js/jquery.dataTables.min.js}"></script>
	<script type="text/javascript" th:src="@{/webjars/moment/2.24.0/min/moment.min.js}"></script>
	<script type="text/javascript"
		th:src="@{/webjars/bootstrap-multiselect/0.9.15/js/bootstrap-multiselect.js}"></script>
	<script type="text/javascript" th:src="@{/js/common/bootstrapValidator.min.js}"></script>
	<script type="text/javascript" th:src="@{/js/app.js}"></script>
	<script type="text/javascript" th:src="@{/js/to_mau/to_mau.js}"></script>
	<script type="text/javascript" th:src="@{/js/to_mau/to_mau_truyen.js}"></script>


	<script type="text/javascript" th:src="@{/js/bootstrap-multiselect.js}"></script>
	<link rel="stylesheet" th:href="@{/css/bootstrap-multiselect.css}">
	>
	<style>
		.upload-btn-wrapper {
			position: relative;
			overflow: hidden;
			display: inline-block;
		}

		.btn-upload {
			border: 2px solid gray;
			color: gray;
			background-color: white;
			padding: 8px 20px;
			border-radius: 8px;
			font-size: 20px;
			font-weight: bold;
		}

		.upload-btn-wrapper input[type=file] {
			font-size: 100px;
			position: absolute;
			left: 0;
			top: 0;
			opacity: 0;
		}
	</style>

</head>

<body>
	<header id="header" class="header">
		<script>
			$("#header").load("/views/common/header.html");
		</script>
	</header>
	<div class="border-type-1" style=""></div>
	<div class="border-type-2" style=""></div>
	<div class="border-type-3" style=""></div>
	<nav id="menu-bar">
		<script>
			$("#menu-bar").load("/views/common/menu.html");
		</script>
	</nav>
	<div class="border-type-1" style=""></div>
	<div class="border-type-4" style=""></div>
	<div class="content" id="content">
		<script>
			$("#content").load("/views/common/dashboard.html");
		</script>
	</div>
	<!-- <footer id="footer" class="footer">
		<script>
			$("#footer").load("views/common/footer.html");
		</script>
	</footer> -->

	<div class="modal fade" id="toMauModal" role="dialog">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header" style="background: #337ab7; color: white;">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Tô màu truyện</h4>
				</div>
				<div class="modal-body" style="min-height: 330px;">
					<div class="upload-btn-wrapper">
						<div class="row">
							<div class="col-md-6 col-sm-6">
								<button class="btn-upload">Chọn ảnh</button>
								<input type="file" name="myfile" />
							</div>
							<div class="col-md-6 col-sm-6">
								<label id="file-name" style="margin-top: 25px;"></label>
							</div>
						</div>
					</div>
					</br>
					<div>
						<img id="myImg" src="#" alt=""
							style="max-width: 300px; max-height: 350px; margin-left: 20px;" />

						<img id="wait" style="display: none; margin-left: 30px;margin-top: -28%;margin-left: 65%;"
							src='/css/loading.gif' width="64" height="64" />

					</div>


				</div>
				<div class="modal-footer">
					<button type="button" id="updateModal" class="btn btn-primary" onclick="toMau()">Tô màu</button>
					<button type="button" class="btn btn-danger" onclick="closeToMauModal()">Đóng</button>
				</div>
			</div>

		</div>
	</div>
	<div class="modal fade" id="toMauModal" role="dialog">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header" style="background: #337ab7; color: white;">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Tô màu truyện</h4>
				</div>
				<div class="modal-body" style="min-height: 330px;">
					<div class="upload-btn-wrapper">
						<div class="row">
							<div class="col-md-6 col-sm-6">
								<button class="btn-upload">Chọn ảnh</button>
								<input type="file" name="myfile" />
							</div>
							<div class="col-md-6 col-sm-6">
								<label id="file-name" style="margin-top: 25px;"></label>
							</div>
						</div>
					</div>
					</br>
					<div class="row">

						<div style="width: 310px; height: 360px;">
							<img id="myImg" src="#" alt=""
								style="max-width: 300px; max-height: 350px; margin-left: 20px;" />
							<div id="wait" style="display: none; margin-left: 30px;">
								<img src='/css/loading.gif' width="64" height="64" /><br>Loading..
							</div>
						</div>

					</div>


				</div>

			</div>

		</div>
	</div>
	<script>
		function imageIsLoaded(e) {
			$('#myImg').attr('src', e.target.result);
		};
		function toMau() {
			var imageName = $('#file-name').text();
			var image = imageName.split(".")[0] + ".png";
			var outputImageUrl = "https://algorithmia.com/v1/data/.algo/deeplearning/ColorfulImageColorization/temp/"
				+ image;
			var input = {
				"image": "data://buingoctuyen/demo/" + imageName
			};
			console.log(imageName);
			console.log(input);
			$("#wait").css("display", "block");
			Algorithmia
				.client("simw9Ynnhpg5dzGgRCyOHMmpG0X1")
				.algo(
					"deeplearning/ColorfulImageColorization/1.1.13?timeout=300") // timeout is optional
				.pipe(input).then(function (output) {
					console.log(output);
					$("#wait").css("display", "none");
					window.open(outputImageUrl);
				});

		};
		function closeToMauModal() {
			$('#toMauModal').modal('toggle');
		}
	</script>
</body>

</html>